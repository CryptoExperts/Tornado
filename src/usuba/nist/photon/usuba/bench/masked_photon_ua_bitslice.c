/* This code was generated by Usuba.
   See https://github.com/DadaIsCrazy/usuba.
   From the file "nist/photon/usuba/ua/photon_bitslice.ua" (included below). */

#include <stdint.h>

/* Do NOT change the order of those define/include */

#ifndef BITS_PER_REG
#define BITS_PER_REG 32
#endif
/* including the architecture specific .h */
#include "MASKED_UA.h"

/* auxiliary functions */
void Sbox__B1 (/*inputs*/ DATATYPE X3[MASKING_ORDER],DATATYPE X2[MASKING_ORDER],DATATYPE X1[MASKING_ORDER],DATATYPE X0[MASKING_ORDER], /*outputs*/ DATATYPE Y3[MASKING_ORDER],DATATYPE Y2[MASKING_ORDER],DATATYPE Y1[MASKING_ORDER],DATATYPE Y0[MASKING_ORDER]) {

  // Variables declaration
  DATATYPE T1[MASKING_ORDER];
  DATATYPE T2[MASKING_ORDER];
  DATATYPE T3[MASKING_ORDER];
  DATATYPE T4[MASKING_ORDER];
  DATATYPE T5[MASKING_ORDER];
  DATATYPE T6[MASKING_ORDER];
  DATATYPE T7[MASKING_ORDER];
  DATATYPE T8[MASKING_ORDER];
  DATATYPE T9[MASKING_ORDER];
  DATATYPE _tmp1_[MASKING_ORDER];

  // Instructions (body)
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    T1[_mask_idx] = XOR(X1[_mask_idx],X2[_mask_idx]);
  }
  MASKED_AND(T2,X2,T1);
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    T3[_mask_idx] = XOR(X3[_mask_idx],T2[_mask_idx]);
    Y0[_mask_idx] = XOR(X0[_mask_idx],T3[_mask_idx]);
    T5[_mask_idx] = XOR(T1[_mask_idx],Y0[_mask_idx]);
  }
  MASKED_AND(T4,T1,T3);
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    T6[_mask_idx] = XOR(T4[_mask_idx],X2[_mask_idx]);
  }
  MASKED_OR(T7,X0,T6);
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    Y1[_mask_idx] = XOR(T5[_mask_idx],T7[_mask_idx]);
  }
  _tmp1_[0] = NOT(X0[0]);
  for (int _mask_idx = 1; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    _tmp1_[_mask_idx] = X0[_mask_idx];
  }
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    T8[_mask_idx] = XOR(T6[_mask_idx],_tmp1_[_mask_idx]);
    Y3[_mask_idx] = XOR(Y1[_mask_idx],T8[_mask_idx]);
  }
  MASKED_OR(T9,T8,T5);
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    Y2[_mask_idx] = XOR(T3[_mask_idx],T9[_mask_idx]);
  }

}

void SubCells__B1 (/*inputs*/ DATATYPE x__[8][8][4][MASKING_ORDER], /*outputs*/ DATATYPE y__[8][8][4][MASKING_ORDER]) {

  // Variables declaration
  ;

  // Instructions (body)
  for (int i__ = 0; i__ <= 7; i__++) {
    for (int j__ = 0; j__ <= 7; j__++) {
      Sbox__B1(x__[i__][j__][0],x__[i__][j__][1],x__[i__][j__][2],x__[i__][j__][3],y__[i__][j__][0],y__[i__][j__][1],y__[i__][j__][2],y__[i__][j__][3]);
    }
  }

}

void ShiftRows__B1 (/*inputs*/ DATATYPE x__[8][8][4][MASKING_ORDER], /*outputs*/ DATATYPE y__[8][8][4][MASKING_ORDER]) {

  // Variables declaration
  ;

  // Instructions (body)
  for (int i__ = 0; i__ <= 7; i__++) {
    for (int j__ = 0; j__ <= 7; j__++) {
      for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
        y__[i__][j__][0][_mask_idx] = x__[i__][((j__ + i__) % 8)][0][_mask_idx];
        y__[i__][j__][1][_mask_idx] = x__[i__][((j__ + i__) % 8)][1][_mask_idx];
        y__[i__][j__][2][_mask_idx] = x__[i__][((j__ + i__) % 8)][2][_mask_idx];
        y__[i__][j__][3][_mask_idx] = x__[i__][((j__ + i__) % 8)][3][_mask_idx];
      }
    }
  }

}

void AddConstant__B1 (/*inputs*/ DATATYPE x__[8][8][4][MASKING_ORDER],DATATYPE rc__[4][MASKING_ORDER], /*outputs*/ DATATYPE y__[8][8][4][MASKING_ORDER]) {

  // Variables declaration
  DATATYPE IC__[8][4][MASKING_ORDER];
  DATATYPE _tmp10_[8][4][MASKING_ORDER];

  // Instructions (body)
  IC__[0][0][0] = SET_ALL_ZERO();
  for (int _mask_idx = 1; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    IC__[0][0][_mask_idx] = SET_ALL_ZERO();
    IC__[0][1][_mask_idx] = SET_ALL_ZERO();
    IC__[0][2][_mask_idx] = SET_ALL_ZERO();
    IC__[0][3][_mask_idx] = SET_ALL_ZERO();
    IC__[1][0][_mask_idx] = SET_ALL_ZERO();
    IC__[1][1][_mask_idx] = SET_ALL_ZERO();
    IC__[1][2][_mask_idx] = SET_ALL_ZERO();
    IC__[1][3][_mask_idx] = SET_ALL_ZERO();
    IC__[2][0][_mask_idx] = SET_ALL_ZERO();
    IC__[2][1][_mask_idx] = SET_ALL_ZERO();
    IC__[2][2][_mask_idx] = SET_ALL_ZERO();
    IC__[2][3][_mask_idx] = SET_ALL_ZERO();
    IC__[3][0][_mask_idx] = SET_ALL_ZERO();
    IC__[3][1][_mask_idx] = SET_ALL_ZERO();
    IC__[3][2][_mask_idx] = SET_ALL_ZERO();
    IC__[3][3][_mask_idx] = SET_ALL_ZERO();
    IC__[4][0][_mask_idx] = SET_ALL_ZERO();
    IC__[4][1][_mask_idx] = SET_ALL_ZERO();
    IC__[4][2][_mask_idx] = SET_ALL_ZERO();
    IC__[4][3][_mask_idx] = SET_ALL_ZERO();
    IC__[5][0][_mask_idx] = SET_ALL_ZERO();
    IC__[5][1][_mask_idx] = SET_ALL_ZERO();
    IC__[5][2][_mask_idx] = SET_ALL_ZERO();
    IC__[5][3][_mask_idx] = SET_ALL_ZERO();
    IC__[6][0][_mask_idx] = SET_ALL_ZERO();
    IC__[6][1][_mask_idx] = SET_ALL_ZERO();
    IC__[6][2][_mask_idx] = SET_ALL_ZERO();
    IC__[6][3][_mask_idx] = SET_ALL_ZERO();
    IC__[7][0][_mask_idx] = SET_ALL_ZERO();
    IC__[7][1][_mask_idx] = SET_ALL_ZERO();
    IC__[7][2][_mask_idx] = SET_ALL_ZERO();
    IC__[7][3][_mask_idx] = SET_ALL_ZERO();
  }
  IC__[0][1][0] = SET_ALL_ZERO();
  IC__[0][2][0] = SET_ALL_ZERO();
  IC__[0][3][0] = SET_ALL_ZERO();
  IC__[1][0][0] = SET_ALL_ZERO();
  IC__[1][1][0] = SET_ALL_ZERO();
  IC__[1][2][0] = SET_ALL_ZERO();
  IC__[1][3][0] = SET_ALL_ONE();
  IC__[2][0][0] = SET_ALL_ZERO();
  IC__[2][1][0] = SET_ALL_ZERO();
  IC__[2][2][0] = SET_ALL_ONE();
  IC__[2][3][0] = SET_ALL_ONE();
  IC__[3][0][0] = SET_ALL_ZERO();
  IC__[3][1][0] = SET_ALL_ONE();
  IC__[3][2][0] = SET_ALL_ONE();
  IC__[3][3][0] = SET_ALL_ONE();
  IC__[4][0][0] = SET_ALL_ONE();
  IC__[4][1][0] = SET_ALL_ONE();
  IC__[4][2][0] = SET_ALL_ONE();
  IC__[4][3][0] = SET_ALL_ONE();
  IC__[5][0][0] = SET_ALL_ONE();
  IC__[5][1][0] = SET_ALL_ONE();
  IC__[5][2][0] = SET_ALL_ONE();
  IC__[5][3][0] = SET_ALL_ZERO();
  IC__[6][0][0] = SET_ALL_ONE();
  IC__[6][1][0] = SET_ALL_ONE();
  IC__[6][2][0] = SET_ALL_ZERO();
  IC__[6][3][0] = SET_ALL_ZERO();
  IC__[7][0][0] = SET_ALL_ONE();
  IC__[7][1][0] = SET_ALL_ZERO();
  IC__[7][2][0] = SET_ALL_ZERO();
  IC__[7][3][0] = SET_ALL_ZERO();
  for (int i__ = 0; i__ <= 7; i__++) {
    for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
      _tmp10_[i__][0][_mask_idx] = XOR(x__[i__][0][0][_mask_idx],rc__[0][_mask_idx]);
      _tmp10_[i__][1][_mask_idx] = XOR(x__[i__][0][1][_mask_idx],rc__[1][_mask_idx]);
      _tmp10_[i__][2][_mask_idx] = XOR(x__[i__][0][2][_mask_idx],rc__[2][_mask_idx]);
      _tmp10_[i__][3][_mask_idx] = XOR(x__[i__][0][3][_mask_idx],rc__[3][_mask_idx]);
      y__[i__][0][0][_mask_idx] = XOR(_tmp10_[i__][0][_mask_idx],IC__[i__][0][_mask_idx]);
      y__[i__][0][1][_mask_idx] = XOR(_tmp10_[i__][1][_mask_idx],IC__[i__][1][_mask_idx]);
      y__[i__][0][2][_mask_idx] = XOR(_tmp10_[i__][2][_mask_idx],IC__[i__][2][_mask_idx]);
      y__[i__][0][3][_mask_idx] = XOR(_tmp10_[i__][3][_mask_idx],IC__[i__][3][_mask_idx]);
      y__[i__][1][0][_mask_idx] = x__[i__][1][0][_mask_idx];
      y__[i__][1][1][_mask_idx] = x__[i__][1][1][_mask_idx];
      y__[i__][1][2][_mask_idx] = x__[i__][1][2][_mask_idx];
      y__[i__][1][3][_mask_idx] = x__[i__][1][3][_mask_idx];
      y__[i__][2][0][_mask_idx] = x__[i__][2][0][_mask_idx];
      y__[i__][2][1][_mask_idx] = x__[i__][2][1][_mask_idx];
      y__[i__][2][2][_mask_idx] = x__[i__][2][2][_mask_idx];
      y__[i__][2][3][_mask_idx] = x__[i__][2][3][_mask_idx];
      y__[i__][3][0][_mask_idx] = x__[i__][3][0][_mask_idx];
      y__[i__][3][1][_mask_idx] = x__[i__][3][1][_mask_idx];
      y__[i__][3][2][_mask_idx] = x__[i__][3][2][_mask_idx];
      y__[i__][3][3][_mask_idx] = x__[i__][3][3][_mask_idx];
      y__[i__][4][0][_mask_idx] = x__[i__][4][0][_mask_idx];
      y__[i__][4][1][_mask_idx] = x__[i__][4][1][_mask_idx];
      y__[i__][4][2][_mask_idx] = x__[i__][4][2][_mask_idx];
      y__[i__][4][3][_mask_idx] = x__[i__][4][3][_mask_idx];
      y__[i__][5][0][_mask_idx] = x__[i__][5][0][_mask_idx];
      y__[i__][5][1][_mask_idx] = x__[i__][5][1][_mask_idx];
      y__[i__][5][2][_mask_idx] = x__[i__][5][2][_mask_idx];
      y__[i__][5][3][_mask_idx] = x__[i__][5][3][_mask_idx];
      y__[i__][6][0][_mask_idx] = x__[i__][6][0][_mask_idx];
      y__[i__][6][1][_mask_idx] = x__[i__][6][1][_mask_idx];
      y__[i__][6][2][_mask_idx] = x__[i__][6][2][_mask_idx];
      y__[i__][6][3][_mask_idx] = x__[i__][6][3][_mask_idx];
      y__[i__][7][0][_mask_idx] = x__[i__][7][0][_mask_idx];
      y__[i__][7][1][_mask_idx] = x__[i__][7][1][_mask_idx];
      y__[i__][7][2][_mask_idx] = x__[i__][7][2][_mask_idx];
      y__[i__][7][3][_mask_idx] = x__[i__][7][3][_mask_idx];
    }
  }

}

void xtimes__B1 (/*inputs*/ DATATYPE e__[4][MASKING_ORDER], /*outputs*/ DATATYPE e____[4][MASKING_ORDER]) {

  // Variables declaration
  ;

  // Instructions (body)
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    e____[0][_mask_idx] = e__[1][_mask_idx];
    e____[1][_mask_idx] = e__[2][_mask_idx];
    e____[2][_mask_idx] = XOR(e__[3][_mask_idx],e__[0][_mask_idx]);
    e____[3][_mask_idx] = e__[0][_mask_idx];
  }

}

void step__B1 (/*inputs*/ DATATYPE x__[8][4][MASKING_ORDER], /*outputs*/ DATATYPE x____[8][4][MASKING_ORDER]) {

  // Variables declaration
  DATATYPE _shadow_acc__1_[4][MASKING_ORDER];
  DATATYPE _shadow_acc__2_[4][MASKING_ORDER];
  DATATYPE _shadow_acc__3_[4][MASKING_ORDER];
  DATATYPE _shadow_acc__4_[4][MASKING_ORDER];
  DATATYPE _shadow_acc__5_[4][MASKING_ORDER];
  DATATYPE _shadow_acc__6_[4][MASKING_ORDER];
  DATATYPE _shadow_acc__7_[4][MASKING_ORDER];
  DATATYPE _tmp16_[4][MASKING_ORDER];
  DATATYPE _tmp17_[4][MASKING_ORDER];
  DATATYPE _tmp18_[4][MASKING_ORDER];
  DATATYPE _tmp19_[4][MASKING_ORDER];
  DATATYPE _tmp20_[4][MASKING_ORDER];
  DATATYPE _tmp21_[4][MASKING_ORDER];
  DATATYPE _tmp22_[4][MASKING_ORDER];

  // Instructions (body)
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    _shadow_acc__1_[0][_mask_idx] = XOR(x__[3][0][_mask_idx],x__[5][0][_mask_idx]);
    _shadow_acc__1_[1][_mask_idx] = XOR(x__[3][1][_mask_idx],x__[5][1][_mask_idx]);
    _shadow_acc__1_[2][_mask_idx] = XOR(x__[3][2][_mask_idx],x__[5][2][_mask_idx]);
    _shadow_acc__1_[3][_mask_idx] = XOR(x__[3][3][_mask_idx],x__[5][3][_mask_idx]);
    x____[0][0][_mask_idx] = x__[1][0][_mask_idx];
    x____[0][1][_mask_idx] = x__[1][1][_mask_idx];
    x____[0][2][_mask_idx] = x__[1][2][_mask_idx];
    x____[0][3][_mask_idx] = x__[1][3][_mask_idx];
    x____[1][0][_mask_idx] = x__[2][0][_mask_idx];
    x____[1][1][_mask_idx] = x__[2][1][_mask_idx];
    x____[1][2][_mask_idx] = x__[2][2][_mask_idx];
    x____[1][3][_mask_idx] = x__[2][3][_mask_idx];
    x____[2][0][_mask_idx] = x__[3][0][_mask_idx];
    x____[2][1][_mask_idx] = x__[3][1][_mask_idx];
    x____[2][2][_mask_idx] = x__[3][2][_mask_idx];
    x____[2][3][_mask_idx] = x__[3][3][_mask_idx];
    x____[3][0][_mask_idx] = x__[4][0][_mask_idx];
    x____[3][1][_mask_idx] = x__[4][1][_mask_idx];
    x____[3][2][_mask_idx] = x__[4][2][_mask_idx];
    x____[3][3][_mask_idx] = x__[4][3][_mask_idx];
    x____[4][0][_mask_idx] = x__[5][0][_mask_idx];
    x____[4][1][_mask_idx] = x__[5][1][_mask_idx];
    x____[4][2][_mask_idx] = x__[5][2][_mask_idx];
    x____[4][3][_mask_idx] = x__[5][3][_mask_idx];
    x____[5][0][_mask_idx] = x__[6][0][_mask_idx];
    x____[5][1][_mask_idx] = x__[6][1][_mask_idx];
    x____[5][2][_mask_idx] = x__[6][2][_mask_idx];
    x____[5][3][_mask_idx] = x__[6][3][_mask_idx];
    x____[6][0][_mask_idx] = x__[7][0][_mask_idx];
    x____[6][1][_mask_idx] = x__[7][1][_mask_idx];
    x____[6][2][_mask_idx] = x__[7][2][_mask_idx];
    x____[6][3][_mask_idx] = x__[7][3][_mask_idx];
  }
  xtimes__B1(_shadow_acc__1_,_shadow_acc__2_);
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    _tmp16_[0][_mask_idx] = XOR(_shadow_acc__2_[0][_mask_idx],x__[1][0][_mask_idx]);
    _tmp16_[1][_mask_idx] = XOR(_shadow_acc__2_[1][_mask_idx],x__[1][1][_mask_idx]);
    _tmp16_[2][_mask_idx] = XOR(_shadow_acc__2_[2][_mask_idx],x__[1][2][_mask_idx]);
    _tmp16_[3][_mask_idx] = XOR(_shadow_acc__2_[3][_mask_idx],x__[1][3][_mask_idx]);
    _tmp17_[0][_mask_idx] = XOR(_tmp16_[0][_mask_idx],x__[6][0][_mask_idx]);
    _tmp17_[1][_mask_idx] = XOR(_tmp16_[1][_mask_idx],x__[6][1][_mask_idx]);
    _tmp17_[2][_mask_idx] = XOR(_tmp16_[2][_mask_idx],x__[6][2][_mask_idx]);
    _tmp17_[3][_mask_idx] = XOR(_tmp16_[3][_mask_idx],x__[6][3][_mask_idx]);
    _shadow_acc__3_[0][_mask_idx] = XOR(_tmp17_[0][_mask_idx],x__[7][0][_mask_idx]);
    _shadow_acc__3_[1][_mask_idx] = XOR(_tmp17_[1][_mask_idx],x__[7][1][_mask_idx]);
    _shadow_acc__3_[2][_mask_idx] = XOR(_tmp17_[2][_mask_idx],x__[7][2][_mask_idx]);
    _shadow_acc__3_[3][_mask_idx] = XOR(_tmp17_[3][_mask_idx],x__[7][3][_mask_idx]);
  }
  xtimes__B1(_shadow_acc__3_,_shadow_acc__4_);
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    _tmp18_[0][_mask_idx] = XOR(_shadow_acc__4_[0][_mask_idx],x__[0][0][_mask_idx]);
    _tmp18_[1][_mask_idx] = XOR(_shadow_acc__4_[1][_mask_idx],x__[0][1][_mask_idx]);
    _tmp18_[2][_mask_idx] = XOR(_shadow_acc__4_[2][_mask_idx],x__[0][2][_mask_idx]);
    _tmp18_[3][_mask_idx] = XOR(_shadow_acc__4_[3][_mask_idx],x__[0][3][_mask_idx]);
    _tmp19_[0][_mask_idx] = XOR(_tmp18_[0][_mask_idx],x__[2][0][_mask_idx]);
    _tmp19_[1][_mask_idx] = XOR(_tmp18_[1][_mask_idx],x__[2][1][_mask_idx]);
    _tmp19_[2][_mask_idx] = XOR(_tmp18_[2][_mask_idx],x__[2][2][_mask_idx]);
    _tmp19_[3][_mask_idx] = XOR(_tmp18_[3][_mask_idx],x__[2][3][_mask_idx]);
    _tmp20_[0][_mask_idx] = XOR(_tmp19_[0][_mask_idx],x__[3][0][_mask_idx]);
    _tmp20_[1][_mask_idx] = XOR(_tmp19_[1][_mask_idx],x__[3][1][_mask_idx]);
    _tmp20_[2][_mask_idx] = XOR(_tmp19_[2][_mask_idx],x__[3][2][_mask_idx]);
    _tmp20_[3][_mask_idx] = XOR(_tmp19_[3][_mask_idx],x__[3][3][_mask_idx]);
    _tmp21_[0][_mask_idx] = XOR(_tmp20_[0][_mask_idx],x__[4][0][_mask_idx]);
    _tmp21_[1][_mask_idx] = XOR(_tmp20_[1][_mask_idx],x__[4][1][_mask_idx]);
    _tmp21_[2][_mask_idx] = XOR(_tmp20_[2][_mask_idx],x__[4][2][_mask_idx]);
    _tmp21_[3][_mask_idx] = XOR(_tmp20_[3][_mask_idx],x__[4][3][_mask_idx]);
    _shadow_acc__5_[0][_mask_idx] = XOR(_tmp21_[0][_mask_idx],x__[7][0][_mask_idx]);
    _shadow_acc__5_[1][_mask_idx] = XOR(_tmp21_[1][_mask_idx],x__[7][1][_mask_idx]);
    _shadow_acc__5_[2][_mask_idx] = XOR(_tmp21_[2][_mask_idx],x__[7][2][_mask_idx]);
    _shadow_acc__5_[3][_mask_idx] = XOR(_tmp21_[3][_mask_idx],x__[7][3][_mask_idx]);
  }
  xtimes__B1(_shadow_acc__5_,_shadow_acc__6_);
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    _tmp22_[0][_mask_idx] = XOR(_shadow_acc__6_[0][_mask_idx],x__[3][0][_mask_idx]);
    _tmp22_[1][_mask_idx] = XOR(_shadow_acc__6_[1][_mask_idx],x__[3][1][_mask_idx]);
    _tmp22_[2][_mask_idx] = XOR(_shadow_acc__6_[2][_mask_idx],x__[3][2][_mask_idx]);
    _tmp22_[3][_mask_idx] = XOR(_shadow_acc__6_[3][_mask_idx],x__[3][3][_mask_idx]);
    _shadow_acc__7_[0][_mask_idx] = XOR(_tmp22_[0][_mask_idx],x__[6][0][_mask_idx]);
    _shadow_acc__7_[1][_mask_idx] = XOR(_tmp22_[1][_mask_idx],x__[6][1][_mask_idx]);
    _shadow_acc__7_[2][_mask_idx] = XOR(_tmp22_[2][_mask_idx],x__[6][2][_mask_idx]);
    _shadow_acc__7_[3][_mask_idx] = XOR(_tmp22_[3][_mask_idx],x__[6][3][_mask_idx]);
    x____[7][0][_mask_idx] = _shadow_acc__7_[0][_mask_idx];
    x____[7][1][_mask_idx] = _shadow_acc__7_[1][_mask_idx];
    x____[7][2][_mask_idx] = _shadow_acc__7_[2][_mask_idx];
    x____[7][3][_mask_idx] = _shadow_acc__7_[3][_mask_idx];
  }

}

void MixColumnRow__B1 (/*inputs*/ DATATYPE X__0__[4][MASKING_ORDER],DATATYPE X__1__[4][MASKING_ORDER],DATATYPE X__2__[4][MASKING_ORDER],DATATYPE X__3__[4][MASKING_ORDER],DATATYPE X__4__[4][MASKING_ORDER],DATATYPE X__5__[4][MASKING_ORDER],DATATYPE X__6__[4][MASKING_ORDER],DATATYPE X__7__[4][MASKING_ORDER], /*outputs*/ DATATYPE Y__0__[4][MASKING_ORDER],DATATYPE Y__1__[4][MASKING_ORDER],DATATYPE Y__2__[4][MASKING_ORDER],DATATYPE Y__3__[4][MASKING_ORDER],DATATYPE Y__4__[4][MASKING_ORDER],DATATYPE Y__5__[4][MASKING_ORDER],DATATYPE Y__6__[4][MASKING_ORDER],DATATYPE Y__7__[4][MASKING_ORDER]) {

  // Variables declaration
  DATATYPE x__[9][8][4][MASKING_ORDER];

  // Instructions (body)
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    x__[0][0][0][_mask_idx] = X__0__[0][_mask_idx];
    x__[0][0][1][_mask_idx] = X__0__[1][_mask_idx];
    x__[0][0][2][_mask_idx] = X__0__[2][_mask_idx];
    x__[0][0][3][_mask_idx] = X__0__[3][_mask_idx];
    x__[0][1][0][_mask_idx] = X__1__[0][_mask_idx];
    x__[0][1][1][_mask_idx] = X__1__[1][_mask_idx];
    x__[0][1][2][_mask_idx] = X__1__[2][_mask_idx];
    x__[0][1][3][_mask_idx] = X__1__[3][_mask_idx];
    x__[0][2][0][_mask_idx] = X__2__[0][_mask_idx];
    x__[0][2][1][_mask_idx] = X__2__[1][_mask_idx];
    x__[0][2][2][_mask_idx] = X__2__[2][_mask_idx];
    x__[0][2][3][_mask_idx] = X__2__[3][_mask_idx];
    x__[0][3][0][_mask_idx] = X__3__[0][_mask_idx];
    x__[0][3][1][_mask_idx] = X__3__[1][_mask_idx];
    x__[0][3][2][_mask_idx] = X__3__[2][_mask_idx];
    x__[0][3][3][_mask_idx] = X__3__[3][_mask_idx];
    x__[0][4][0][_mask_idx] = X__4__[0][_mask_idx];
    x__[0][4][1][_mask_idx] = X__4__[1][_mask_idx];
    x__[0][4][2][_mask_idx] = X__4__[2][_mask_idx];
    x__[0][4][3][_mask_idx] = X__4__[3][_mask_idx];
    x__[0][5][0][_mask_idx] = X__5__[0][_mask_idx];
    x__[0][5][1][_mask_idx] = X__5__[1][_mask_idx];
    x__[0][5][2][_mask_idx] = X__5__[2][_mask_idx];
    x__[0][5][3][_mask_idx] = X__5__[3][_mask_idx];
    x__[0][6][0][_mask_idx] = X__6__[0][_mask_idx];
    x__[0][6][1][_mask_idx] = X__6__[1][_mask_idx];
    x__[0][6][2][_mask_idx] = X__6__[2][_mask_idx];
    x__[0][6][3][_mask_idx] = X__6__[3][_mask_idx];
    x__[0][7][0][_mask_idx] = X__7__[0][_mask_idx];
    x__[0][7][1][_mask_idx] = X__7__[1][_mask_idx];
    x__[0][7][2][_mask_idx] = X__7__[2][_mask_idx];
    x__[0][7][3][_mask_idx] = X__7__[3][_mask_idx];
  }
  for (int i__ = 0; i__ <= 7; i__++) {
    step__B1(x__[i__],x__[(i__ + 1)]);
  }
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    Y__0__[0][_mask_idx] = x__[8][0][0][_mask_idx];
    Y__0__[1][_mask_idx] = x__[8][0][1][_mask_idx];
    Y__0__[2][_mask_idx] = x__[8][0][2][_mask_idx];
    Y__0__[3][_mask_idx] = x__[8][0][3][_mask_idx];
    Y__1__[0][_mask_idx] = x__[8][1][0][_mask_idx];
    Y__1__[1][_mask_idx] = x__[8][1][1][_mask_idx];
    Y__1__[2][_mask_idx] = x__[8][1][2][_mask_idx];
    Y__1__[3][_mask_idx] = x__[8][1][3][_mask_idx];
    Y__2__[0][_mask_idx] = x__[8][2][0][_mask_idx];
    Y__2__[1][_mask_idx] = x__[8][2][1][_mask_idx];
    Y__2__[2][_mask_idx] = x__[8][2][2][_mask_idx];
    Y__2__[3][_mask_idx] = x__[8][2][3][_mask_idx];
    Y__3__[0][_mask_idx] = x__[8][3][0][_mask_idx];
    Y__3__[1][_mask_idx] = x__[8][3][1][_mask_idx];
    Y__3__[2][_mask_idx] = x__[8][3][2][_mask_idx];
    Y__3__[3][_mask_idx] = x__[8][3][3][_mask_idx];
    Y__4__[0][_mask_idx] = x__[8][4][0][_mask_idx];
    Y__4__[1][_mask_idx] = x__[8][4][1][_mask_idx];
    Y__4__[2][_mask_idx] = x__[8][4][2][_mask_idx];
    Y__4__[3][_mask_idx] = x__[8][4][3][_mask_idx];
    Y__5__[0][_mask_idx] = x__[8][5][0][_mask_idx];
    Y__5__[1][_mask_idx] = x__[8][5][1][_mask_idx];
    Y__5__[2][_mask_idx] = x__[8][5][2][_mask_idx];
    Y__5__[3][_mask_idx] = x__[8][5][3][_mask_idx];
    Y__6__[0][_mask_idx] = x__[8][6][0][_mask_idx];
    Y__6__[1][_mask_idx] = x__[8][6][1][_mask_idx];
    Y__6__[2][_mask_idx] = x__[8][6][2][_mask_idx];
    Y__6__[3][_mask_idx] = x__[8][6][3][_mask_idx];
    Y__7__[0][_mask_idx] = x__[8][7][0][_mask_idx];
    Y__7__[1][_mask_idx] = x__[8][7][1][_mask_idx];
    Y__7__[2][_mask_idx] = x__[8][7][2][_mask_idx];
    Y__7__[3][_mask_idx] = x__[8][7][3][_mask_idx];
  }

}

void MixColumnSerial__B1 (/*inputs*/ DATATYPE X__[8][8][4][MASKING_ORDER], /*outputs*/ DATATYPE Y__[8][8][4][MASKING_ORDER]) {

  // Variables declaration
  ;

  // Instructions (body)
  for (int i__ = 0; i__ <= 7; i__++) {
    MixColumnRow__B1(X__[0][i__],X__[1][i__],X__[2][i__],X__[3][i__],X__[4][i__],X__[5][i__],X__[6][i__],X__[7][i__],Y__[0][i__],Y__[1][i__],Y__[2][i__],Y__[3][i__],Y__[4][i__],Y__[5][i__],Y__[6][i__],Y__[7][i__]);
  }

}

/* main function */
void Photon__ (/*inputs*/ DATATYPE plain__[8][8][4][MASKING_ORDER], /*outputs*/ DATATYPE cipher__[8][8][4][MASKING_ORDER]) {

  // Variables declaration
  DATATYPE RC__[12][4][MASKING_ORDER];
  DATATYPE _tmp36_[12][8][8][4][MASKING_ORDER];
  DATATYPE _tmp37_[12][8][8][4][MASKING_ORDER];
  DATATYPE _tmp38_[12][8][8][4][MASKING_ORDER];
  DATATYPE state__[13][8][8][4][MASKING_ORDER];

  // Instructions (body)
  RC__[0][0][0] = SET_ALL_ZERO();
  for (int _mask_idx = 1; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    RC__[0][0][_mask_idx] = SET_ALL_ZERO();
    RC__[0][1][_mask_idx] = SET_ALL_ZERO();
    RC__[0][2][_mask_idx] = SET_ALL_ZERO();
    RC__[0][3][_mask_idx] = SET_ALL_ZERO();
    RC__[1][0][_mask_idx] = SET_ALL_ZERO();
    RC__[1][1][_mask_idx] = SET_ALL_ZERO();
    RC__[1][2][_mask_idx] = SET_ALL_ZERO();
    RC__[1][3][_mask_idx] = SET_ALL_ZERO();
    RC__[2][0][_mask_idx] = SET_ALL_ZERO();
    RC__[2][1][_mask_idx] = SET_ALL_ZERO();
    RC__[2][2][_mask_idx] = SET_ALL_ZERO();
    RC__[2][3][_mask_idx] = SET_ALL_ZERO();
    RC__[3][0][_mask_idx] = SET_ALL_ZERO();
    RC__[3][1][_mask_idx] = SET_ALL_ZERO();
    RC__[3][2][_mask_idx] = SET_ALL_ZERO();
    RC__[3][3][_mask_idx] = SET_ALL_ZERO();
    RC__[4][0][_mask_idx] = SET_ALL_ZERO();
    RC__[4][1][_mask_idx] = SET_ALL_ZERO();
    RC__[4][2][_mask_idx] = SET_ALL_ZERO();
    RC__[4][3][_mask_idx] = SET_ALL_ZERO();
    RC__[5][0][_mask_idx] = SET_ALL_ZERO();
    RC__[5][1][_mask_idx] = SET_ALL_ZERO();
    RC__[5][2][_mask_idx] = SET_ALL_ZERO();
    RC__[5][3][_mask_idx] = SET_ALL_ZERO();
    RC__[6][0][_mask_idx] = SET_ALL_ZERO();
    RC__[6][1][_mask_idx] = SET_ALL_ZERO();
    RC__[6][2][_mask_idx] = SET_ALL_ZERO();
    RC__[6][3][_mask_idx] = SET_ALL_ZERO();
    RC__[7][0][_mask_idx] = SET_ALL_ZERO();
    RC__[7][1][_mask_idx] = SET_ALL_ZERO();
    RC__[7][2][_mask_idx] = SET_ALL_ZERO();
    RC__[7][3][_mask_idx] = SET_ALL_ZERO();
    RC__[8][0][_mask_idx] = SET_ALL_ZERO();
    RC__[8][1][_mask_idx] = SET_ALL_ZERO();
    RC__[8][2][_mask_idx] = SET_ALL_ZERO();
    RC__[8][3][_mask_idx] = SET_ALL_ZERO();
    RC__[9][0][_mask_idx] = SET_ALL_ZERO();
    RC__[9][1][_mask_idx] = SET_ALL_ZERO();
    RC__[9][2][_mask_idx] = SET_ALL_ZERO();
    RC__[9][3][_mask_idx] = SET_ALL_ZERO();
    RC__[10][0][_mask_idx] = SET_ALL_ZERO();
    RC__[10][1][_mask_idx] = SET_ALL_ZERO();
    RC__[10][2][_mask_idx] = SET_ALL_ZERO();
    RC__[10][3][_mask_idx] = SET_ALL_ZERO();
    RC__[11][0][_mask_idx] = SET_ALL_ZERO();
    RC__[11][1][_mask_idx] = SET_ALL_ZERO();
    RC__[11][2][_mask_idx] = SET_ALL_ZERO();
    RC__[11][3][_mask_idx] = SET_ALL_ZERO();
  }
  RC__[0][1][0] = SET_ALL_ZERO();
  RC__[0][2][0] = SET_ALL_ZERO();
  RC__[0][3][0] = SET_ALL_ONE();
  RC__[1][0][0] = SET_ALL_ZERO();
  RC__[1][1][0] = SET_ALL_ZERO();
  RC__[1][2][0] = SET_ALL_ONE();
  RC__[1][3][0] = SET_ALL_ONE();
  RC__[2][0][0] = SET_ALL_ZERO();
  RC__[2][1][0] = SET_ALL_ONE();
  RC__[2][2][0] = SET_ALL_ONE();
  RC__[2][3][0] = SET_ALL_ONE();
  RC__[3][0][0] = SET_ALL_ONE();
  RC__[3][1][0] = SET_ALL_ONE();
  RC__[3][2][0] = SET_ALL_ONE();
  RC__[3][3][0] = SET_ALL_ZERO();
  RC__[4][0][0] = SET_ALL_ONE();
  RC__[4][1][0] = SET_ALL_ONE();
  RC__[4][2][0] = SET_ALL_ZERO();
  RC__[4][3][0] = SET_ALL_ONE();
  RC__[5][0][0] = SET_ALL_ONE();
  RC__[5][1][0] = SET_ALL_ZERO();
  RC__[5][2][0] = SET_ALL_ONE();
  RC__[5][3][0] = SET_ALL_ONE();
  RC__[6][0][0] = SET_ALL_ZERO();
  RC__[6][1][0] = SET_ALL_ONE();
  RC__[6][2][0] = SET_ALL_ONE();
  RC__[6][3][0] = SET_ALL_ZERO();
  RC__[7][0][0] = SET_ALL_ONE();
  RC__[7][1][0] = SET_ALL_ONE();
  RC__[7][2][0] = SET_ALL_ZERO();
  RC__[7][3][0] = SET_ALL_ZERO();
  RC__[8][0][0] = SET_ALL_ONE();
  RC__[8][1][0] = SET_ALL_ZERO();
  RC__[8][2][0] = SET_ALL_ZERO();
  RC__[8][3][0] = SET_ALL_ONE();
  RC__[9][0][0] = SET_ALL_ZERO();
  RC__[9][1][0] = SET_ALL_ZERO();
  RC__[9][2][0] = SET_ALL_ONE();
  RC__[9][3][0] = SET_ALL_ZERO();
  RC__[10][0][0] = SET_ALL_ZERO();
  RC__[10][1][0] = SET_ALL_ONE();
  RC__[10][2][0] = SET_ALL_ZERO();
  RC__[10][3][0] = SET_ALL_ONE();
  RC__[11][0][0] = SET_ALL_ONE();
  RC__[11][1][0] = SET_ALL_ZERO();
  RC__[11][2][0] = SET_ALL_ONE();
  RC__[11][3][0] = SET_ALL_ZERO();
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    state__[0][0][0][0][_mask_idx] = plain__[0][0][0][_mask_idx];
    state__[0][0][0][1][_mask_idx] = plain__[0][0][1][_mask_idx];
    state__[0][0][0][2][_mask_idx] = plain__[0][0][2][_mask_idx];
    state__[0][0][0][3][_mask_idx] = plain__[0][0][3][_mask_idx];
    state__[0][0][1][0][_mask_idx] = plain__[0][1][0][_mask_idx];
    state__[0][0][1][1][_mask_idx] = plain__[0][1][1][_mask_idx];
    state__[0][0][1][2][_mask_idx] = plain__[0][1][2][_mask_idx];
    state__[0][0][1][3][_mask_idx] = plain__[0][1][3][_mask_idx];
    state__[0][0][2][0][_mask_idx] = plain__[0][2][0][_mask_idx];
    state__[0][0][2][1][_mask_idx] = plain__[0][2][1][_mask_idx];
    state__[0][0][2][2][_mask_idx] = plain__[0][2][2][_mask_idx];
    state__[0][0][2][3][_mask_idx] = plain__[0][2][3][_mask_idx];
    state__[0][0][3][0][_mask_idx] = plain__[0][3][0][_mask_idx];
    state__[0][0][3][1][_mask_idx] = plain__[0][3][1][_mask_idx];
    state__[0][0][3][2][_mask_idx] = plain__[0][3][2][_mask_idx];
    state__[0][0][3][3][_mask_idx] = plain__[0][3][3][_mask_idx];
    state__[0][0][4][0][_mask_idx] = plain__[0][4][0][_mask_idx];
    state__[0][0][4][1][_mask_idx] = plain__[0][4][1][_mask_idx];
    state__[0][0][4][2][_mask_idx] = plain__[0][4][2][_mask_idx];
    state__[0][0][4][3][_mask_idx] = plain__[0][4][3][_mask_idx];
    state__[0][0][5][0][_mask_idx] = plain__[0][5][0][_mask_idx];
    state__[0][0][5][1][_mask_idx] = plain__[0][5][1][_mask_idx];
    state__[0][0][5][2][_mask_idx] = plain__[0][5][2][_mask_idx];
    state__[0][0][5][3][_mask_idx] = plain__[0][5][3][_mask_idx];
    state__[0][0][6][0][_mask_idx] = plain__[0][6][0][_mask_idx];
    state__[0][0][6][1][_mask_idx] = plain__[0][6][1][_mask_idx];
    state__[0][0][6][2][_mask_idx] = plain__[0][6][2][_mask_idx];
    state__[0][0][6][3][_mask_idx] = plain__[0][6][3][_mask_idx];
    state__[0][0][7][0][_mask_idx] = plain__[0][7][0][_mask_idx];
    state__[0][0][7][1][_mask_idx] = plain__[0][7][1][_mask_idx];
    state__[0][0][7][2][_mask_idx] = plain__[0][7][2][_mask_idx];
    state__[0][0][7][3][_mask_idx] = plain__[0][7][3][_mask_idx];
    state__[0][1][0][0][_mask_idx] = plain__[1][0][0][_mask_idx];
    state__[0][1][0][1][_mask_idx] = plain__[1][0][1][_mask_idx];
    state__[0][1][0][2][_mask_idx] = plain__[1][0][2][_mask_idx];
    state__[0][1][0][3][_mask_idx] = plain__[1][0][3][_mask_idx];
    state__[0][1][1][0][_mask_idx] = plain__[1][1][0][_mask_idx];
    state__[0][1][1][1][_mask_idx] = plain__[1][1][1][_mask_idx];
    state__[0][1][1][2][_mask_idx] = plain__[1][1][2][_mask_idx];
    state__[0][1][1][3][_mask_idx] = plain__[1][1][3][_mask_idx];
    state__[0][1][2][0][_mask_idx] = plain__[1][2][0][_mask_idx];
    state__[0][1][2][1][_mask_idx] = plain__[1][2][1][_mask_idx];
    state__[0][1][2][2][_mask_idx] = plain__[1][2][2][_mask_idx];
    state__[0][1][2][3][_mask_idx] = plain__[1][2][3][_mask_idx];
    state__[0][1][3][0][_mask_idx] = plain__[1][3][0][_mask_idx];
    state__[0][1][3][1][_mask_idx] = plain__[1][3][1][_mask_idx];
    state__[0][1][3][2][_mask_idx] = plain__[1][3][2][_mask_idx];
    state__[0][1][3][3][_mask_idx] = plain__[1][3][3][_mask_idx];
    state__[0][1][4][0][_mask_idx] = plain__[1][4][0][_mask_idx];
    state__[0][1][4][1][_mask_idx] = plain__[1][4][1][_mask_idx];
    state__[0][1][4][2][_mask_idx] = plain__[1][4][2][_mask_idx];
    state__[0][1][4][3][_mask_idx] = plain__[1][4][3][_mask_idx];
    state__[0][1][5][0][_mask_idx] = plain__[1][5][0][_mask_idx];
    state__[0][1][5][1][_mask_idx] = plain__[1][5][1][_mask_idx];
    state__[0][1][5][2][_mask_idx] = plain__[1][5][2][_mask_idx];
    state__[0][1][5][3][_mask_idx] = plain__[1][5][3][_mask_idx];
    state__[0][1][6][0][_mask_idx] = plain__[1][6][0][_mask_idx];
    state__[0][1][6][1][_mask_idx] = plain__[1][6][1][_mask_idx];
    state__[0][1][6][2][_mask_idx] = plain__[1][6][2][_mask_idx];
    state__[0][1][6][3][_mask_idx] = plain__[1][6][3][_mask_idx];
    state__[0][1][7][0][_mask_idx] = plain__[1][7][0][_mask_idx];
    state__[0][1][7][1][_mask_idx] = plain__[1][7][1][_mask_idx];
    state__[0][1][7][2][_mask_idx] = plain__[1][7][2][_mask_idx];
    state__[0][1][7][3][_mask_idx] = plain__[1][7][3][_mask_idx];
    state__[0][2][0][0][_mask_idx] = plain__[2][0][0][_mask_idx];
    state__[0][2][0][1][_mask_idx] = plain__[2][0][1][_mask_idx];
    state__[0][2][0][2][_mask_idx] = plain__[2][0][2][_mask_idx];
    state__[0][2][0][3][_mask_idx] = plain__[2][0][3][_mask_idx];
    state__[0][2][1][0][_mask_idx] = plain__[2][1][0][_mask_idx];
    state__[0][2][1][1][_mask_idx] = plain__[2][1][1][_mask_idx];
    state__[0][2][1][2][_mask_idx] = plain__[2][1][2][_mask_idx];
    state__[0][2][1][3][_mask_idx] = plain__[2][1][3][_mask_idx];
    state__[0][2][2][0][_mask_idx] = plain__[2][2][0][_mask_idx];
    state__[0][2][2][1][_mask_idx] = plain__[2][2][1][_mask_idx];
    state__[0][2][2][2][_mask_idx] = plain__[2][2][2][_mask_idx];
    state__[0][2][2][3][_mask_idx] = plain__[2][2][3][_mask_idx];
    state__[0][2][3][0][_mask_idx] = plain__[2][3][0][_mask_idx];
    state__[0][2][3][1][_mask_idx] = plain__[2][3][1][_mask_idx];
    state__[0][2][3][2][_mask_idx] = plain__[2][3][2][_mask_idx];
    state__[0][2][3][3][_mask_idx] = plain__[2][3][3][_mask_idx];
    state__[0][2][4][0][_mask_idx] = plain__[2][4][0][_mask_idx];
    state__[0][2][4][1][_mask_idx] = plain__[2][4][1][_mask_idx];
    state__[0][2][4][2][_mask_idx] = plain__[2][4][2][_mask_idx];
    state__[0][2][4][3][_mask_idx] = plain__[2][4][3][_mask_idx];
    state__[0][2][5][0][_mask_idx] = plain__[2][5][0][_mask_idx];
    state__[0][2][5][1][_mask_idx] = plain__[2][5][1][_mask_idx];
    state__[0][2][5][2][_mask_idx] = plain__[2][5][2][_mask_idx];
    state__[0][2][5][3][_mask_idx] = plain__[2][5][3][_mask_idx];
    state__[0][2][6][0][_mask_idx] = plain__[2][6][0][_mask_idx];
    state__[0][2][6][1][_mask_idx] = plain__[2][6][1][_mask_idx];
    state__[0][2][6][2][_mask_idx] = plain__[2][6][2][_mask_idx];
    state__[0][2][6][3][_mask_idx] = plain__[2][6][3][_mask_idx];
    state__[0][2][7][0][_mask_idx] = plain__[2][7][0][_mask_idx];
    state__[0][2][7][1][_mask_idx] = plain__[2][7][1][_mask_idx];
    state__[0][2][7][2][_mask_idx] = plain__[2][7][2][_mask_idx];
    state__[0][2][7][3][_mask_idx] = plain__[2][7][3][_mask_idx];
    state__[0][3][0][0][_mask_idx] = plain__[3][0][0][_mask_idx];
    state__[0][3][0][1][_mask_idx] = plain__[3][0][1][_mask_idx];
    state__[0][3][0][2][_mask_idx] = plain__[3][0][2][_mask_idx];
    state__[0][3][0][3][_mask_idx] = plain__[3][0][3][_mask_idx];
    state__[0][3][1][0][_mask_idx] = plain__[3][1][0][_mask_idx];
    state__[0][3][1][1][_mask_idx] = plain__[3][1][1][_mask_idx];
    state__[0][3][1][2][_mask_idx] = plain__[3][1][2][_mask_idx];
    state__[0][3][1][3][_mask_idx] = plain__[3][1][3][_mask_idx];
    state__[0][3][2][0][_mask_idx] = plain__[3][2][0][_mask_idx];
    state__[0][3][2][1][_mask_idx] = plain__[3][2][1][_mask_idx];
    state__[0][3][2][2][_mask_idx] = plain__[3][2][2][_mask_idx];
    state__[0][3][2][3][_mask_idx] = plain__[3][2][3][_mask_idx];
    state__[0][3][3][0][_mask_idx] = plain__[3][3][0][_mask_idx];
    state__[0][3][3][1][_mask_idx] = plain__[3][3][1][_mask_idx];
    state__[0][3][3][2][_mask_idx] = plain__[3][3][2][_mask_idx];
    state__[0][3][3][3][_mask_idx] = plain__[3][3][3][_mask_idx];
    state__[0][3][4][0][_mask_idx] = plain__[3][4][0][_mask_idx];
    state__[0][3][4][1][_mask_idx] = plain__[3][4][1][_mask_idx];
    state__[0][3][4][2][_mask_idx] = plain__[3][4][2][_mask_idx];
    state__[0][3][4][3][_mask_idx] = plain__[3][4][3][_mask_idx];
    state__[0][3][5][0][_mask_idx] = plain__[3][5][0][_mask_idx];
    state__[0][3][5][1][_mask_idx] = plain__[3][5][1][_mask_idx];
    state__[0][3][5][2][_mask_idx] = plain__[3][5][2][_mask_idx];
    state__[0][3][5][3][_mask_idx] = plain__[3][5][3][_mask_idx];
    state__[0][3][6][0][_mask_idx] = plain__[3][6][0][_mask_idx];
    state__[0][3][6][1][_mask_idx] = plain__[3][6][1][_mask_idx];
    state__[0][3][6][2][_mask_idx] = plain__[3][6][2][_mask_idx];
    state__[0][3][6][3][_mask_idx] = plain__[3][6][3][_mask_idx];
    state__[0][3][7][0][_mask_idx] = plain__[3][7][0][_mask_idx];
    state__[0][3][7][1][_mask_idx] = plain__[3][7][1][_mask_idx];
    state__[0][3][7][2][_mask_idx] = plain__[3][7][2][_mask_idx];
    state__[0][3][7][3][_mask_idx] = plain__[3][7][3][_mask_idx];
    state__[0][4][0][0][_mask_idx] = plain__[4][0][0][_mask_idx];
    state__[0][4][0][1][_mask_idx] = plain__[4][0][1][_mask_idx];
    state__[0][4][0][2][_mask_idx] = plain__[4][0][2][_mask_idx];
    state__[0][4][0][3][_mask_idx] = plain__[4][0][3][_mask_idx];
    state__[0][4][1][0][_mask_idx] = plain__[4][1][0][_mask_idx];
    state__[0][4][1][1][_mask_idx] = plain__[4][1][1][_mask_idx];
    state__[0][4][1][2][_mask_idx] = plain__[4][1][2][_mask_idx];
    state__[0][4][1][3][_mask_idx] = plain__[4][1][3][_mask_idx];
    state__[0][4][2][0][_mask_idx] = plain__[4][2][0][_mask_idx];
    state__[0][4][2][1][_mask_idx] = plain__[4][2][1][_mask_idx];
    state__[0][4][2][2][_mask_idx] = plain__[4][2][2][_mask_idx];
    state__[0][4][2][3][_mask_idx] = plain__[4][2][3][_mask_idx];
    state__[0][4][3][0][_mask_idx] = plain__[4][3][0][_mask_idx];
    state__[0][4][3][1][_mask_idx] = plain__[4][3][1][_mask_idx];
    state__[0][4][3][2][_mask_idx] = plain__[4][3][2][_mask_idx];
    state__[0][4][3][3][_mask_idx] = plain__[4][3][3][_mask_idx];
    state__[0][4][4][0][_mask_idx] = plain__[4][4][0][_mask_idx];
    state__[0][4][4][1][_mask_idx] = plain__[4][4][1][_mask_idx];
    state__[0][4][4][2][_mask_idx] = plain__[4][4][2][_mask_idx];
    state__[0][4][4][3][_mask_idx] = plain__[4][4][3][_mask_idx];
    state__[0][4][5][0][_mask_idx] = plain__[4][5][0][_mask_idx];
    state__[0][4][5][1][_mask_idx] = plain__[4][5][1][_mask_idx];
    state__[0][4][5][2][_mask_idx] = plain__[4][5][2][_mask_idx];
    state__[0][4][5][3][_mask_idx] = plain__[4][5][3][_mask_idx];
    state__[0][4][6][0][_mask_idx] = plain__[4][6][0][_mask_idx];
    state__[0][4][6][1][_mask_idx] = plain__[4][6][1][_mask_idx];
    state__[0][4][6][2][_mask_idx] = plain__[4][6][2][_mask_idx];
    state__[0][4][6][3][_mask_idx] = plain__[4][6][3][_mask_idx];
    state__[0][4][7][0][_mask_idx] = plain__[4][7][0][_mask_idx];
    state__[0][4][7][1][_mask_idx] = plain__[4][7][1][_mask_idx];
    state__[0][4][7][2][_mask_idx] = plain__[4][7][2][_mask_idx];
    state__[0][4][7][3][_mask_idx] = plain__[4][7][3][_mask_idx];
    state__[0][5][0][0][_mask_idx] = plain__[5][0][0][_mask_idx];
    state__[0][5][0][1][_mask_idx] = plain__[5][0][1][_mask_idx];
    state__[0][5][0][2][_mask_idx] = plain__[5][0][2][_mask_idx];
    state__[0][5][0][3][_mask_idx] = plain__[5][0][3][_mask_idx];
    state__[0][5][1][0][_mask_idx] = plain__[5][1][0][_mask_idx];
    state__[0][5][1][1][_mask_idx] = plain__[5][1][1][_mask_idx];
    state__[0][5][1][2][_mask_idx] = plain__[5][1][2][_mask_idx];
    state__[0][5][1][3][_mask_idx] = plain__[5][1][3][_mask_idx];
    state__[0][5][2][0][_mask_idx] = plain__[5][2][0][_mask_idx];
    state__[0][5][2][1][_mask_idx] = plain__[5][2][1][_mask_idx];
    state__[0][5][2][2][_mask_idx] = plain__[5][2][2][_mask_idx];
    state__[0][5][2][3][_mask_idx] = plain__[5][2][3][_mask_idx];
    state__[0][5][3][0][_mask_idx] = plain__[5][3][0][_mask_idx];
    state__[0][5][3][1][_mask_idx] = plain__[5][3][1][_mask_idx];
    state__[0][5][3][2][_mask_idx] = plain__[5][3][2][_mask_idx];
    state__[0][5][3][3][_mask_idx] = plain__[5][3][3][_mask_idx];
    state__[0][5][4][0][_mask_idx] = plain__[5][4][0][_mask_idx];
    state__[0][5][4][1][_mask_idx] = plain__[5][4][1][_mask_idx];
    state__[0][5][4][2][_mask_idx] = plain__[5][4][2][_mask_idx];
    state__[0][5][4][3][_mask_idx] = plain__[5][4][3][_mask_idx];
    state__[0][5][5][0][_mask_idx] = plain__[5][5][0][_mask_idx];
    state__[0][5][5][1][_mask_idx] = plain__[5][5][1][_mask_idx];
    state__[0][5][5][2][_mask_idx] = plain__[5][5][2][_mask_idx];
    state__[0][5][5][3][_mask_idx] = plain__[5][5][3][_mask_idx];
    state__[0][5][6][0][_mask_idx] = plain__[5][6][0][_mask_idx];
    state__[0][5][6][1][_mask_idx] = plain__[5][6][1][_mask_idx];
    state__[0][5][6][2][_mask_idx] = plain__[5][6][2][_mask_idx];
    state__[0][5][6][3][_mask_idx] = plain__[5][6][3][_mask_idx];
    state__[0][5][7][0][_mask_idx] = plain__[5][7][0][_mask_idx];
    state__[0][5][7][1][_mask_idx] = plain__[5][7][1][_mask_idx];
    state__[0][5][7][2][_mask_idx] = plain__[5][7][2][_mask_idx];
    state__[0][5][7][3][_mask_idx] = plain__[5][7][3][_mask_idx];
    state__[0][6][0][0][_mask_idx] = plain__[6][0][0][_mask_idx];
    state__[0][6][0][1][_mask_idx] = plain__[6][0][1][_mask_idx];
    state__[0][6][0][2][_mask_idx] = plain__[6][0][2][_mask_idx];
    state__[0][6][0][3][_mask_idx] = plain__[6][0][3][_mask_idx];
    state__[0][6][1][0][_mask_idx] = plain__[6][1][0][_mask_idx];
    state__[0][6][1][1][_mask_idx] = plain__[6][1][1][_mask_idx];
    state__[0][6][1][2][_mask_idx] = plain__[6][1][2][_mask_idx];
    state__[0][6][1][3][_mask_idx] = plain__[6][1][3][_mask_idx];
    state__[0][6][2][0][_mask_idx] = plain__[6][2][0][_mask_idx];
    state__[0][6][2][1][_mask_idx] = plain__[6][2][1][_mask_idx];
    state__[0][6][2][2][_mask_idx] = plain__[6][2][2][_mask_idx];
    state__[0][6][2][3][_mask_idx] = plain__[6][2][3][_mask_idx];
    state__[0][6][3][0][_mask_idx] = plain__[6][3][0][_mask_idx];
    state__[0][6][3][1][_mask_idx] = plain__[6][3][1][_mask_idx];
    state__[0][6][3][2][_mask_idx] = plain__[6][3][2][_mask_idx];
    state__[0][6][3][3][_mask_idx] = plain__[6][3][3][_mask_idx];
    state__[0][6][4][0][_mask_idx] = plain__[6][4][0][_mask_idx];
    state__[0][6][4][1][_mask_idx] = plain__[6][4][1][_mask_idx];
    state__[0][6][4][2][_mask_idx] = plain__[6][4][2][_mask_idx];
    state__[0][6][4][3][_mask_idx] = plain__[6][4][3][_mask_idx];
    state__[0][6][5][0][_mask_idx] = plain__[6][5][0][_mask_idx];
    state__[0][6][5][1][_mask_idx] = plain__[6][5][1][_mask_idx];
    state__[0][6][5][2][_mask_idx] = plain__[6][5][2][_mask_idx];
    state__[0][6][5][3][_mask_idx] = plain__[6][5][3][_mask_idx];
    state__[0][6][6][0][_mask_idx] = plain__[6][6][0][_mask_idx];
    state__[0][6][6][1][_mask_idx] = plain__[6][6][1][_mask_idx];
    state__[0][6][6][2][_mask_idx] = plain__[6][6][2][_mask_idx];
    state__[0][6][6][3][_mask_idx] = plain__[6][6][3][_mask_idx];
    state__[0][6][7][0][_mask_idx] = plain__[6][7][0][_mask_idx];
    state__[0][6][7][1][_mask_idx] = plain__[6][7][1][_mask_idx];
    state__[0][6][7][2][_mask_idx] = plain__[6][7][2][_mask_idx];
    state__[0][6][7][3][_mask_idx] = plain__[6][7][3][_mask_idx];
    state__[0][7][0][0][_mask_idx] = plain__[7][0][0][_mask_idx];
    state__[0][7][0][1][_mask_idx] = plain__[7][0][1][_mask_idx];
    state__[0][7][0][2][_mask_idx] = plain__[7][0][2][_mask_idx];
    state__[0][7][0][3][_mask_idx] = plain__[7][0][3][_mask_idx];
    state__[0][7][1][0][_mask_idx] = plain__[7][1][0][_mask_idx];
    state__[0][7][1][1][_mask_idx] = plain__[7][1][1][_mask_idx];
    state__[0][7][1][2][_mask_idx] = plain__[7][1][2][_mask_idx];
    state__[0][7][1][3][_mask_idx] = plain__[7][1][3][_mask_idx];
    state__[0][7][2][0][_mask_idx] = plain__[7][2][0][_mask_idx];
    state__[0][7][2][1][_mask_idx] = plain__[7][2][1][_mask_idx];
    state__[0][7][2][2][_mask_idx] = plain__[7][2][2][_mask_idx];
    state__[0][7][2][3][_mask_idx] = plain__[7][2][3][_mask_idx];
    state__[0][7][3][0][_mask_idx] = plain__[7][3][0][_mask_idx];
    state__[0][7][3][1][_mask_idx] = plain__[7][3][1][_mask_idx];
    state__[0][7][3][2][_mask_idx] = plain__[7][3][2][_mask_idx];
    state__[0][7][3][3][_mask_idx] = plain__[7][3][3][_mask_idx];
    state__[0][7][4][0][_mask_idx] = plain__[7][4][0][_mask_idx];
    state__[0][7][4][1][_mask_idx] = plain__[7][4][1][_mask_idx];
    state__[0][7][4][2][_mask_idx] = plain__[7][4][2][_mask_idx];
    state__[0][7][4][3][_mask_idx] = plain__[7][4][3][_mask_idx];
    state__[0][7][5][0][_mask_idx] = plain__[7][5][0][_mask_idx];
    state__[0][7][5][1][_mask_idx] = plain__[7][5][1][_mask_idx];
    state__[0][7][5][2][_mask_idx] = plain__[7][5][2][_mask_idx];
    state__[0][7][5][3][_mask_idx] = plain__[7][5][3][_mask_idx];
    state__[0][7][6][0][_mask_idx] = plain__[7][6][0][_mask_idx];
    state__[0][7][6][1][_mask_idx] = plain__[7][6][1][_mask_idx];
    state__[0][7][6][2][_mask_idx] = plain__[7][6][2][_mask_idx];
    state__[0][7][6][3][_mask_idx] = plain__[7][6][3][_mask_idx];
    state__[0][7][7][0][_mask_idx] = plain__[7][7][0][_mask_idx];
    state__[0][7][7][1][_mask_idx] = plain__[7][7][1][_mask_idx];
    state__[0][7][7][2][_mask_idx] = plain__[7][7][2][_mask_idx];
    state__[0][7][7][3][_mask_idx] = plain__[7][7][3][_mask_idx];
  }
  for (int i__ = 0; i__ <= 11; i__++) {
    AddConstant__B1(state__[i__],RC__[i__],_tmp36_[i__]);
    SubCells__B1(_tmp36_[i__],_tmp37_[i__]);
    ShiftRows__B1(_tmp37_[i__],_tmp38_[i__]);
    MixColumnSerial__B1(_tmp38_[i__],state__[(i__ + 1)]);
  }
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    cipher__[0][0][0][_mask_idx] = state__[12][0][0][0][_mask_idx];
    cipher__[0][0][1][_mask_idx] = state__[12][0][0][1][_mask_idx];
    cipher__[0][0][2][_mask_idx] = state__[12][0][0][2][_mask_idx];
    cipher__[0][0][3][_mask_idx] = state__[12][0][0][3][_mask_idx];
    cipher__[0][1][0][_mask_idx] = state__[12][0][1][0][_mask_idx];
    cipher__[0][1][1][_mask_idx] = state__[12][0][1][1][_mask_idx];
    cipher__[0][1][2][_mask_idx] = state__[12][0][1][2][_mask_idx];
    cipher__[0][1][3][_mask_idx] = state__[12][0][1][3][_mask_idx];
    cipher__[0][2][0][_mask_idx] = state__[12][0][2][0][_mask_idx];
    cipher__[0][2][1][_mask_idx] = state__[12][0][2][1][_mask_idx];
    cipher__[0][2][2][_mask_idx] = state__[12][0][2][2][_mask_idx];
    cipher__[0][2][3][_mask_idx] = state__[12][0][2][3][_mask_idx];
    cipher__[0][3][0][_mask_idx] = state__[12][0][3][0][_mask_idx];
    cipher__[0][3][1][_mask_idx] = state__[12][0][3][1][_mask_idx];
    cipher__[0][3][2][_mask_idx] = state__[12][0][3][2][_mask_idx];
    cipher__[0][3][3][_mask_idx] = state__[12][0][3][3][_mask_idx];
    cipher__[0][4][0][_mask_idx] = state__[12][0][4][0][_mask_idx];
    cipher__[0][4][1][_mask_idx] = state__[12][0][4][1][_mask_idx];
    cipher__[0][4][2][_mask_idx] = state__[12][0][4][2][_mask_idx];
    cipher__[0][4][3][_mask_idx] = state__[12][0][4][3][_mask_idx];
    cipher__[0][5][0][_mask_idx] = state__[12][0][5][0][_mask_idx];
    cipher__[0][5][1][_mask_idx] = state__[12][0][5][1][_mask_idx];
    cipher__[0][5][2][_mask_idx] = state__[12][0][5][2][_mask_idx];
    cipher__[0][5][3][_mask_idx] = state__[12][0][5][3][_mask_idx];
    cipher__[0][6][0][_mask_idx] = state__[12][0][6][0][_mask_idx];
    cipher__[0][6][1][_mask_idx] = state__[12][0][6][1][_mask_idx];
    cipher__[0][6][2][_mask_idx] = state__[12][0][6][2][_mask_idx];
    cipher__[0][6][3][_mask_idx] = state__[12][0][6][3][_mask_idx];
    cipher__[0][7][0][_mask_idx] = state__[12][0][7][0][_mask_idx];
    cipher__[0][7][1][_mask_idx] = state__[12][0][7][1][_mask_idx];
    cipher__[0][7][2][_mask_idx] = state__[12][0][7][2][_mask_idx];
    cipher__[0][7][3][_mask_idx] = state__[12][0][7][3][_mask_idx];
    cipher__[1][0][0][_mask_idx] = state__[12][1][0][0][_mask_idx];
    cipher__[1][0][1][_mask_idx] = state__[12][1][0][1][_mask_idx];
    cipher__[1][0][2][_mask_idx] = state__[12][1][0][2][_mask_idx];
    cipher__[1][0][3][_mask_idx] = state__[12][1][0][3][_mask_idx];
    cipher__[1][1][0][_mask_idx] = state__[12][1][1][0][_mask_idx];
    cipher__[1][1][1][_mask_idx] = state__[12][1][1][1][_mask_idx];
    cipher__[1][1][2][_mask_idx] = state__[12][1][1][2][_mask_idx];
    cipher__[1][1][3][_mask_idx] = state__[12][1][1][3][_mask_idx];
    cipher__[1][2][0][_mask_idx] = state__[12][1][2][0][_mask_idx];
    cipher__[1][2][1][_mask_idx] = state__[12][1][2][1][_mask_idx];
    cipher__[1][2][2][_mask_idx] = state__[12][1][2][2][_mask_idx];
    cipher__[1][2][3][_mask_idx] = state__[12][1][2][3][_mask_idx];
    cipher__[1][3][0][_mask_idx] = state__[12][1][3][0][_mask_idx];
    cipher__[1][3][1][_mask_idx] = state__[12][1][3][1][_mask_idx];
    cipher__[1][3][2][_mask_idx] = state__[12][1][3][2][_mask_idx];
    cipher__[1][3][3][_mask_idx] = state__[12][1][3][3][_mask_idx];
    cipher__[1][4][0][_mask_idx] = state__[12][1][4][0][_mask_idx];
    cipher__[1][4][1][_mask_idx] = state__[12][1][4][1][_mask_idx];
    cipher__[1][4][2][_mask_idx] = state__[12][1][4][2][_mask_idx];
    cipher__[1][4][3][_mask_idx] = state__[12][1][4][3][_mask_idx];
    cipher__[1][5][0][_mask_idx] = state__[12][1][5][0][_mask_idx];
    cipher__[1][5][1][_mask_idx] = state__[12][1][5][1][_mask_idx];
    cipher__[1][5][2][_mask_idx] = state__[12][1][5][2][_mask_idx];
    cipher__[1][5][3][_mask_idx] = state__[12][1][5][3][_mask_idx];
    cipher__[1][6][0][_mask_idx] = state__[12][1][6][0][_mask_idx];
    cipher__[1][6][1][_mask_idx] = state__[12][1][6][1][_mask_idx];
    cipher__[1][6][2][_mask_idx] = state__[12][1][6][2][_mask_idx];
    cipher__[1][6][3][_mask_idx] = state__[12][1][6][3][_mask_idx];
    cipher__[1][7][0][_mask_idx] = state__[12][1][7][0][_mask_idx];
    cipher__[1][7][1][_mask_idx] = state__[12][1][7][1][_mask_idx];
    cipher__[1][7][2][_mask_idx] = state__[12][1][7][2][_mask_idx];
    cipher__[1][7][3][_mask_idx] = state__[12][1][7][3][_mask_idx];
    cipher__[2][0][0][_mask_idx] = state__[12][2][0][0][_mask_idx];
    cipher__[2][0][1][_mask_idx] = state__[12][2][0][1][_mask_idx];
    cipher__[2][0][2][_mask_idx] = state__[12][2][0][2][_mask_idx];
    cipher__[2][0][3][_mask_idx] = state__[12][2][0][3][_mask_idx];
    cipher__[2][1][0][_mask_idx] = state__[12][2][1][0][_mask_idx];
    cipher__[2][1][1][_mask_idx] = state__[12][2][1][1][_mask_idx];
    cipher__[2][1][2][_mask_idx] = state__[12][2][1][2][_mask_idx];
    cipher__[2][1][3][_mask_idx] = state__[12][2][1][3][_mask_idx];
    cipher__[2][2][0][_mask_idx] = state__[12][2][2][0][_mask_idx];
    cipher__[2][2][1][_mask_idx] = state__[12][2][2][1][_mask_idx];
    cipher__[2][2][2][_mask_idx] = state__[12][2][2][2][_mask_idx];
    cipher__[2][2][3][_mask_idx] = state__[12][2][2][3][_mask_idx];
    cipher__[2][3][0][_mask_idx] = state__[12][2][3][0][_mask_idx];
    cipher__[2][3][1][_mask_idx] = state__[12][2][3][1][_mask_idx];
    cipher__[2][3][2][_mask_idx] = state__[12][2][3][2][_mask_idx];
    cipher__[2][3][3][_mask_idx] = state__[12][2][3][3][_mask_idx];
    cipher__[2][4][0][_mask_idx] = state__[12][2][4][0][_mask_idx];
    cipher__[2][4][1][_mask_idx] = state__[12][2][4][1][_mask_idx];
    cipher__[2][4][2][_mask_idx] = state__[12][2][4][2][_mask_idx];
    cipher__[2][4][3][_mask_idx] = state__[12][2][4][3][_mask_idx];
    cipher__[2][5][0][_mask_idx] = state__[12][2][5][0][_mask_idx];
    cipher__[2][5][1][_mask_idx] = state__[12][2][5][1][_mask_idx];
    cipher__[2][5][2][_mask_idx] = state__[12][2][5][2][_mask_idx];
    cipher__[2][5][3][_mask_idx] = state__[12][2][5][3][_mask_idx];
    cipher__[2][6][0][_mask_idx] = state__[12][2][6][0][_mask_idx];
    cipher__[2][6][1][_mask_idx] = state__[12][2][6][1][_mask_idx];
    cipher__[2][6][2][_mask_idx] = state__[12][2][6][2][_mask_idx];
    cipher__[2][6][3][_mask_idx] = state__[12][2][6][3][_mask_idx];
    cipher__[2][7][0][_mask_idx] = state__[12][2][7][0][_mask_idx];
    cipher__[2][7][1][_mask_idx] = state__[12][2][7][1][_mask_idx];
    cipher__[2][7][2][_mask_idx] = state__[12][2][7][2][_mask_idx];
    cipher__[2][7][3][_mask_idx] = state__[12][2][7][3][_mask_idx];
    cipher__[3][0][0][_mask_idx] = state__[12][3][0][0][_mask_idx];
    cipher__[3][0][1][_mask_idx] = state__[12][3][0][1][_mask_idx];
    cipher__[3][0][2][_mask_idx] = state__[12][3][0][2][_mask_idx];
    cipher__[3][0][3][_mask_idx] = state__[12][3][0][3][_mask_idx];
    cipher__[3][1][0][_mask_idx] = state__[12][3][1][0][_mask_idx];
    cipher__[3][1][1][_mask_idx] = state__[12][3][1][1][_mask_idx];
    cipher__[3][1][2][_mask_idx] = state__[12][3][1][2][_mask_idx];
    cipher__[3][1][3][_mask_idx] = state__[12][3][1][3][_mask_idx];
    cipher__[3][2][0][_mask_idx] = state__[12][3][2][0][_mask_idx];
    cipher__[3][2][1][_mask_idx] = state__[12][3][2][1][_mask_idx];
    cipher__[3][2][2][_mask_idx] = state__[12][3][2][2][_mask_idx];
    cipher__[3][2][3][_mask_idx] = state__[12][3][2][3][_mask_idx];
    cipher__[3][3][0][_mask_idx] = state__[12][3][3][0][_mask_idx];
    cipher__[3][3][1][_mask_idx] = state__[12][3][3][1][_mask_idx];
    cipher__[3][3][2][_mask_idx] = state__[12][3][3][2][_mask_idx];
    cipher__[3][3][3][_mask_idx] = state__[12][3][3][3][_mask_idx];
    cipher__[3][4][0][_mask_idx] = state__[12][3][4][0][_mask_idx];
    cipher__[3][4][1][_mask_idx] = state__[12][3][4][1][_mask_idx];
    cipher__[3][4][2][_mask_idx] = state__[12][3][4][2][_mask_idx];
    cipher__[3][4][3][_mask_idx] = state__[12][3][4][3][_mask_idx];
    cipher__[3][5][0][_mask_idx] = state__[12][3][5][0][_mask_idx];
    cipher__[3][5][1][_mask_idx] = state__[12][3][5][1][_mask_idx];
    cipher__[3][5][2][_mask_idx] = state__[12][3][5][2][_mask_idx];
    cipher__[3][5][3][_mask_idx] = state__[12][3][5][3][_mask_idx];
    cipher__[3][6][0][_mask_idx] = state__[12][3][6][0][_mask_idx];
    cipher__[3][6][1][_mask_idx] = state__[12][3][6][1][_mask_idx];
    cipher__[3][6][2][_mask_idx] = state__[12][3][6][2][_mask_idx];
    cipher__[3][6][3][_mask_idx] = state__[12][3][6][3][_mask_idx];
    cipher__[3][7][0][_mask_idx] = state__[12][3][7][0][_mask_idx];
    cipher__[3][7][1][_mask_idx] = state__[12][3][7][1][_mask_idx];
    cipher__[3][7][2][_mask_idx] = state__[12][3][7][2][_mask_idx];
    cipher__[3][7][3][_mask_idx] = state__[12][3][7][3][_mask_idx];
    cipher__[4][0][0][_mask_idx] = state__[12][4][0][0][_mask_idx];
    cipher__[4][0][1][_mask_idx] = state__[12][4][0][1][_mask_idx];
    cipher__[4][0][2][_mask_idx] = state__[12][4][0][2][_mask_idx];
    cipher__[4][0][3][_mask_idx] = state__[12][4][0][3][_mask_idx];
    cipher__[4][1][0][_mask_idx] = state__[12][4][1][0][_mask_idx];
    cipher__[4][1][1][_mask_idx] = state__[12][4][1][1][_mask_idx];
    cipher__[4][1][2][_mask_idx] = state__[12][4][1][2][_mask_idx];
    cipher__[4][1][3][_mask_idx] = state__[12][4][1][3][_mask_idx];
    cipher__[4][2][0][_mask_idx] = state__[12][4][2][0][_mask_idx];
    cipher__[4][2][1][_mask_idx] = state__[12][4][2][1][_mask_idx];
    cipher__[4][2][2][_mask_idx] = state__[12][4][2][2][_mask_idx];
    cipher__[4][2][3][_mask_idx] = state__[12][4][2][3][_mask_idx];
    cipher__[4][3][0][_mask_idx] = state__[12][4][3][0][_mask_idx];
    cipher__[4][3][1][_mask_idx] = state__[12][4][3][1][_mask_idx];
    cipher__[4][3][2][_mask_idx] = state__[12][4][3][2][_mask_idx];
    cipher__[4][3][3][_mask_idx] = state__[12][4][3][3][_mask_idx];
    cipher__[4][4][0][_mask_idx] = state__[12][4][4][0][_mask_idx];
    cipher__[4][4][1][_mask_idx] = state__[12][4][4][1][_mask_idx];
    cipher__[4][4][2][_mask_idx] = state__[12][4][4][2][_mask_idx];
    cipher__[4][4][3][_mask_idx] = state__[12][4][4][3][_mask_idx];
    cipher__[4][5][0][_mask_idx] = state__[12][4][5][0][_mask_idx];
    cipher__[4][5][1][_mask_idx] = state__[12][4][5][1][_mask_idx];
    cipher__[4][5][2][_mask_idx] = state__[12][4][5][2][_mask_idx];
    cipher__[4][5][3][_mask_idx] = state__[12][4][5][3][_mask_idx];
    cipher__[4][6][0][_mask_idx] = state__[12][4][6][0][_mask_idx];
    cipher__[4][6][1][_mask_idx] = state__[12][4][6][1][_mask_idx];
    cipher__[4][6][2][_mask_idx] = state__[12][4][6][2][_mask_idx];
    cipher__[4][6][3][_mask_idx] = state__[12][4][6][3][_mask_idx];
    cipher__[4][7][0][_mask_idx] = state__[12][4][7][0][_mask_idx];
    cipher__[4][7][1][_mask_idx] = state__[12][4][7][1][_mask_idx];
    cipher__[4][7][2][_mask_idx] = state__[12][4][7][2][_mask_idx];
    cipher__[4][7][3][_mask_idx] = state__[12][4][7][3][_mask_idx];
    cipher__[5][0][0][_mask_idx] = state__[12][5][0][0][_mask_idx];
    cipher__[5][0][1][_mask_idx] = state__[12][5][0][1][_mask_idx];
    cipher__[5][0][2][_mask_idx] = state__[12][5][0][2][_mask_idx];
    cipher__[5][0][3][_mask_idx] = state__[12][5][0][3][_mask_idx];
    cipher__[5][1][0][_mask_idx] = state__[12][5][1][0][_mask_idx];
    cipher__[5][1][1][_mask_idx] = state__[12][5][1][1][_mask_idx];
    cipher__[5][1][2][_mask_idx] = state__[12][5][1][2][_mask_idx];
    cipher__[5][1][3][_mask_idx] = state__[12][5][1][3][_mask_idx];
    cipher__[5][2][0][_mask_idx] = state__[12][5][2][0][_mask_idx];
    cipher__[5][2][1][_mask_idx] = state__[12][5][2][1][_mask_idx];
    cipher__[5][2][2][_mask_idx] = state__[12][5][2][2][_mask_idx];
    cipher__[5][2][3][_mask_idx] = state__[12][5][2][3][_mask_idx];
    cipher__[5][3][0][_mask_idx] = state__[12][5][3][0][_mask_idx];
    cipher__[5][3][1][_mask_idx] = state__[12][5][3][1][_mask_idx];
    cipher__[5][3][2][_mask_idx] = state__[12][5][3][2][_mask_idx];
    cipher__[5][3][3][_mask_idx] = state__[12][5][3][3][_mask_idx];
    cipher__[5][4][0][_mask_idx] = state__[12][5][4][0][_mask_idx];
    cipher__[5][4][1][_mask_idx] = state__[12][5][4][1][_mask_idx];
    cipher__[5][4][2][_mask_idx] = state__[12][5][4][2][_mask_idx];
    cipher__[5][4][3][_mask_idx] = state__[12][5][4][3][_mask_idx];
    cipher__[5][5][0][_mask_idx] = state__[12][5][5][0][_mask_idx];
    cipher__[5][5][1][_mask_idx] = state__[12][5][5][1][_mask_idx];
    cipher__[5][5][2][_mask_idx] = state__[12][5][5][2][_mask_idx];
    cipher__[5][5][3][_mask_idx] = state__[12][5][5][3][_mask_idx];
    cipher__[5][6][0][_mask_idx] = state__[12][5][6][0][_mask_idx];
    cipher__[5][6][1][_mask_idx] = state__[12][5][6][1][_mask_idx];
    cipher__[5][6][2][_mask_idx] = state__[12][5][6][2][_mask_idx];
    cipher__[5][6][3][_mask_idx] = state__[12][5][6][3][_mask_idx];
    cipher__[5][7][0][_mask_idx] = state__[12][5][7][0][_mask_idx];
    cipher__[5][7][1][_mask_idx] = state__[12][5][7][1][_mask_idx];
    cipher__[5][7][2][_mask_idx] = state__[12][5][7][2][_mask_idx];
    cipher__[5][7][3][_mask_idx] = state__[12][5][7][3][_mask_idx];
    cipher__[6][0][0][_mask_idx] = state__[12][6][0][0][_mask_idx];
    cipher__[6][0][1][_mask_idx] = state__[12][6][0][1][_mask_idx];
    cipher__[6][0][2][_mask_idx] = state__[12][6][0][2][_mask_idx];
    cipher__[6][0][3][_mask_idx] = state__[12][6][0][3][_mask_idx];
    cipher__[6][1][0][_mask_idx] = state__[12][6][1][0][_mask_idx];
    cipher__[6][1][1][_mask_idx] = state__[12][6][1][1][_mask_idx];
    cipher__[6][1][2][_mask_idx] = state__[12][6][1][2][_mask_idx];
    cipher__[6][1][3][_mask_idx] = state__[12][6][1][3][_mask_idx];
    cipher__[6][2][0][_mask_idx] = state__[12][6][2][0][_mask_idx];
    cipher__[6][2][1][_mask_idx] = state__[12][6][2][1][_mask_idx];
    cipher__[6][2][2][_mask_idx] = state__[12][6][2][2][_mask_idx];
    cipher__[6][2][3][_mask_idx] = state__[12][6][2][3][_mask_idx];
    cipher__[6][3][0][_mask_idx] = state__[12][6][3][0][_mask_idx];
    cipher__[6][3][1][_mask_idx] = state__[12][6][3][1][_mask_idx];
    cipher__[6][3][2][_mask_idx] = state__[12][6][3][2][_mask_idx];
    cipher__[6][3][3][_mask_idx] = state__[12][6][3][3][_mask_idx];
    cipher__[6][4][0][_mask_idx] = state__[12][6][4][0][_mask_idx];
    cipher__[6][4][1][_mask_idx] = state__[12][6][4][1][_mask_idx];
    cipher__[6][4][2][_mask_idx] = state__[12][6][4][2][_mask_idx];
    cipher__[6][4][3][_mask_idx] = state__[12][6][4][3][_mask_idx];
    cipher__[6][5][0][_mask_idx] = state__[12][6][5][0][_mask_idx];
    cipher__[6][5][1][_mask_idx] = state__[12][6][5][1][_mask_idx];
    cipher__[6][5][2][_mask_idx] = state__[12][6][5][2][_mask_idx];
    cipher__[6][5][3][_mask_idx] = state__[12][6][5][3][_mask_idx];
    cipher__[6][6][0][_mask_idx] = state__[12][6][6][0][_mask_idx];
    cipher__[6][6][1][_mask_idx] = state__[12][6][6][1][_mask_idx];
    cipher__[6][6][2][_mask_idx] = state__[12][6][6][2][_mask_idx];
    cipher__[6][6][3][_mask_idx] = state__[12][6][6][3][_mask_idx];
    cipher__[6][7][0][_mask_idx] = state__[12][6][7][0][_mask_idx];
    cipher__[6][7][1][_mask_idx] = state__[12][6][7][1][_mask_idx];
    cipher__[6][7][2][_mask_idx] = state__[12][6][7][2][_mask_idx];
    cipher__[6][7][3][_mask_idx] = state__[12][6][7][3][_mask_idx];
    cipher__[7][0][0][_mask_idx] = state__[12][7][0][0][_mask_idx];
    cipher__[7][0][1][_mask_idx] = state__[12][7][0][1][_mask_idx];
    cipher__[7][0][2][_mask_idx] = state__[12][7][0][2][_mask_idx];
    cipher__[7][0][3][_mask_idx] = state__[12][7][0][3][_mask_idx];
    cipher__[7][1][0][_mask_idx] = state__[12][7][1][0][_mask_idx];
    cipher__[7][1][1][_mask_idx] = state__[12][7][1][1][_mask_idx];
    cipher__[7][1][2][_mask_idx] = state__[12][7][1][2][_mask_idx];
    cipher__[7][1][3][_mask_idx] = state__[12][7][1][3][_mask_idx];
    cipher__[7][2][0][_mask_idx] = state__[12][7][2][0][_mask_idx];
    cipher__[7][2][1][_mask_idx] = state__[12][7][2][1][_mask_idx];
    cipher__[7][2][2][_mask_idx] = state__[12][7][2][2][_mask_idx];
    cipher__[7][2][3][_mask_idx] = state__[12][7][2][3][_mask_idx];
    cipher__[7][3][0][_mask_idx] = state__[12][7][3][0][_mask_idx];
    cipher__[7][3][1][_mask_idx] = state__[12][7][3][1][_mask_idx];
    cipher__[7][3][2][_mask_idx] = state__[12][7][3][2][_mask_idx];
    cipher__[7][3][3][_mask_idx] = state__[12][7][3][3][_mask_idx];
    cipher__[7][4][0][_mask_idx] = state__[12][7][4][0][_mask_idx];
    cipher__[7][4][1][_mask_idx] = state__[12][7][4][1][_mask_idx];
    cipher__[7][4][2][_mask_idx] = state__[12][7][4][2][_mask_idx];
    cipher__[7][4][3][_mask_idx] = state__[12][7][4][3][_mask_idx];
    cipher__[7][5][0][_mask_idx] = state__[12][7][5][0][_mask_idx];
    cipher__[7][5][1][_mask_idx] = state__[12][7][5][1][_mask_idx];
    cipher__[7][5][2][_mask_idx] = state__[12][7][5][2][_mask_idx];
    cipher__[7][5][3][_mask_idx] = state__[12][7][5][3][_mask_idx];
    cipher__[7][6][0][_mask_idx] = state__[12][7][6][0][_mask_idx];
    cipher__[7][6][1][_mask_idx] = state__[12][7][6][1][_mask_idx];
    cipher__[7][6][2][_mask_idx] = state__[12][7][6][2][_mask_idx];
    cipher__[7][6][3][_mask_idx] = state__[12][7][6][3][_mask_idx];
    cipher__[7][7][0][_mask_idx] = state__[12][7][7][0][_mask_idx];
    cipher__[7][7][1][_mask_idx] = state__[12][7][7][1][_mask_idx];
    cipher__[7][7][2][_mask_idx] = state__[12][7][7][2][_mask_idx];
    cipher__[7][7][3][_mask_idx] = state__[12][7][7][3][_mask_idx];
  }

}

/* Additional functions */
uint32_t bench_speed() {
  /* inputs */
  DATATYPE plain__[8][8][4][MASKING_ORDER] = { 0 };
  /* outputs */
  DATATYPE cipher__[8][8][4][MASKING_ORDER] = { 0 };
  /* fun call */
  Photon__(plain__,cipher__);

  /* Returning the number of encrypted bytes */
  return 1024;
}

/* **************************************************************** */
/*                            Usuba source                          */
/*                                                                  */
/*

 _no_inline table Sbox(x :  b4 :: base)
  returns y :  b4 :: base
{
  12, 5, 6, 11, 9, 0, 10, 13, 3, 14, 15, 8, 4, 7, 1, 2
}


 node SubCells(x :  b4[8][8] :: base)
  returns y :  b4[8][8] :: base
vars

let
  forall i in [0,7] {
    forall j in [0,7] {
      (y[i][j]) = Sbox(x[i][j])
    }
  }
tel

 node ShiftRows(x :  b4[8][8] :: base)
  returns y :  b4[8][8] :: base
vars

let
  forall i in [0,7] {
    forall j in [0,7] {
      (y[i][j]) = x[i][((j + i) % 8)]
    }
  }
tel

 node AddConstant(x :  b4[8][8] :: base,rc :  b4 :: base)
  returns y :  b4[8][8] :: base
vars
  IC :  b4[8] :: base
let
  (IC) = (0,1,3,7,15,14,12,8);
  forall i in [0,7] {
    (y[i][0]) = ((x[i][0] ^ rc) ^ IC[i]);
    (y[i][1 .. 7]) = x[i][1 .. 7]
  }
tel

 node xtimes(e :  b4 :: base)
  returns e' :  b4 :: base
vars
  t :  b4 :: base,
  c :  b4 :: base
let
  (t) = (e << 1);
  (c) = (e >> 3);
  (e') = (((t & 15) ^ c) ^ (c << 1))
tel

 node step(x :  b4[8] :: base)
  returns x' :  b4[8] :: base
vars
  acc :  b4 :: base
let
  (acc) = 0;
  (acc) := ((acc ^ x[3]) ^ x[5]);
  (acc) := xtimes(acc);
  (acc) := (((acc ^ x[1]) ^ x[6]) ^ x[7]);
  (acc) := xtimes(acc);
  (acc) := (((((acc ^ x[0]) ^ x[2]) ^ x[3]) ^ x[4]) ^ x[7]);
  (acc) := xtimes(acc);
  (acc) := ((acc ^ x[3]) ^ x[6]);
  (x') = (x[1 .. 7],acc)
tel

 node MixColumnRow(X :  b4[8] :: base)
  returns Y :  b4[8] :: base
vars
  x :  b4[9][8] :: base,
  y :  b4[9] :: base
let
  forall i in [0,7] {
    (x[0][i]) = (X[i] & 15)
  };
  forall i in [0,7] {
    (x[(i + 1)]) = step(x[i])
  };
  (Y) = x[8]
tel

 node MixColumnSerial(X :  b4[8][8] :: base)
  returns Y :  b4[8][8] :: base
vars

let
  forall i in [0,7] {
    (Y[0 .. 7][i]) = MixColumnRow(X[0 .. 7][i])
  }
tel

 node Photon(plain :  b4[8][8] :: base)
  returns cipher :  b4[8][8] :: base
vars
  RC :  b4[12] :: base,
  state :  b4[13][8][8] :: base
let
  (RC) = (1,3,7,14,13,11,6,12,9,2,5,10);
  (state[0]) = plain;
  forall i in [0,11] {
    (state[(i + 1)]) = MixColumnSerial(ShiftRows(SubCells(AddConstant(state[i],RC[i]))))
  };
  (cipher) = state[12]
tel

*/
 